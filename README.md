# API для игры Сапёр
В обучающих целях реализована игра сапёр. Для осуществления игры приложение принимает POST запросы, а возвращает JSON данные определенного вида. Задание реализовано в рамках тестового задания.
## Описание
Каждая игра начинается с указания размера поля `width` и `height`, а также количества мин `mines_count` на нём.

Далее игроку предлагается в созданной игре (идентификация игры по полученному в ответ `game_id`) делать ходы, указывая координаты ячейки, которую 
игрок хочет открыть, а именно - `row` (номер ряда, начиная с нуля) и `col` (номер колонки, начиная с нуля).

В ответ на оба метода приходят данные о самой игре: уникальный идентификатор игры `game_id`, размер поля и количество мин, указанные при 
создании игры, а также данные о поле `field` в виде двумерного массива символов (`height` строк, в каждой по `width` элементов), 
где пустые строки " " (пробелы) означают неоткрытые ячейки поля, поля с цифрами от "0" до "8" означают открытые ячейки, где цифры указывают, 
сколько мин расположено в непосредственной близости от текущей ячейки. Также возвращается параметр `completed`, указывающий, завершена ли 
текущая игра.

Игра заканчивается в случае, если пользователь указал на ячейку, где установлена мина 
(ячейки с минами при этом отмечены символом "X" - латинская заглавная "икс"), либо пользователь открыл все ячейки, не занятые минами 
(в этом случае мины отмечены "M" - латинская заглавная "эм"). Также при завершении игры появится информация по всем остальным ячейкам - 
количество мин рядом с каждой из ячеек.

Если в процессе игры пользователь открывает ячейку, рядом с которой нет ни одной мины (то есть ячейка со значением "0"), 
"открываются" все смежные ячейки, рядом с которыми также нет ни одной мины, а также все смежные с ними "числовые" ячейки, рядом с которыми мины 
есть, с указанием их количества.

Не допускается после завершения игры делать новые ходы, а также повторно проверять уже проверенную ячейку. 
Эти, а также иные ошибочные ситуации возвращают ошибку с кодом 400 Bad Request с текстовым описание ошибки в error.

## Установка

Скачайте код:
```
git clone https://github.com/K-Mickey/minesweeper-test.git
```
Перейдите в каталог проекта:
```
cd minesweeper-test
```
Установите Python, если этого ещё не сделали.
Возможно, вместо команды python здесь и в остальных инструкциях этого README придётся использовать python3. 
Зависит это от операционной системы и от того, установлен ли у вас Python старой второй версии.

В каталоге проекта создайте виртуальное окружение:
```
python -m venv venv
```
Активируйте его. На разных операционных системах это делается разными командами:
```
Windows: .\venv\Scripts\activate
MacOS/Linux: source venv/bin/activate
```
Установите зависимости в виртуальное окружение:
```
pip install -r requirements.txt
```
Определите переменную окружения SECRET_KEY, DEBUG и ALLOWED_HOSTS. Создайте файл .env в каталоге minesweeper-test/ и положите туда такой код:
```
SECRET_KEY=django-insecure-0if40nf4nf93n4
DEBUG=True
ALLOWED_HOSTS='*'
```
Создайте файл базы данных SQLite и отмигрируйте её следующей командой:
```
python manage.py migrate
```
Запустите сервер:
```
python manage.py runserver
```
Сайт будет доступен в браузере по адресу http://127.0.0.1:8000/.

## Запросы
### POST - Новая игры new
http://../api/new
#### Пример запроса
```
{
  "width": 10,
  "height": 10,
  "mines_count": 10
}
```
#### Пример ответа от сервера
```

  "game_id": "01234567-89AB-CDEF-0123-456789ABCDEF",
  "width": 10,
  "height": 10,
  "mines_count": 10,
  "completed": false,
  "field": [
    [
      " "
    ]
  ]
}
```
### POST - Ход пользователя turn
http://../api/turn
#### Пример запроса
```
{
  "game_id": "01234567-89AB-CDEF-0123-456789ABCDEF",
  "col": 5,
  "row": 5
}
```
#### Пример ответа от сервера
```
{
  "game_id": "01234567-89AB-CDEF-0123-456789ABCDEF",
  "width": 10,
  "height": 10,
  "mines_count": 10,
  "completed": false,
  "field": [
    [
      " "
    ]
  ]
}
```
